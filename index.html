<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>報名表單</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h1>露營報名表單</h1>
  
  <form id="campForm">
    <label for="session">露營場次名稱</label>
    <select id="session" name="session" required>
      <option value="">載入中...</option>
    </select>
    <br><br>

    <label>大人數：</label>
    <input type="number" id="adult" name="adult" min="0" required><br><br>

    <label>半價小孩數(小1到高中，無則填0)：</label>
    <input type="number" id="child" name="child" min="0" required><br><br>

    <label>幼稚園以下小孩數(無則填0)：</label>
    <input type="number" id="kinder" name="kinder" min="0" required><br><br>

    <label>是否夜衝：</label>
    <select id="night" name="night" required>
      <option value="">請選擇</option>
      <option value="是">是</option>
      <option value="否">否</option>
    </select><br><br>

    <label>備註：</label>
    <textarea id="remark" name="remark"></textarea><br><br>

    <button type="submit">送出</button>
  </form>

  <script>
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbzoe_NWqxnoUbpQkKD1CNTYpSnan88X7QZ37BZN_JypZOE_HqpC5VyD-Lsc5oOy_6QY/exec';

    // 載入場次資料
    async function loadSessions() {
      const select = document.getElementById('session');
      select.innerHTML = '<option value="">載入中...</option>';

      try {
        const res = await fetch(GAS_URL);
        const data = await res.json();

        if (data.length === 0) {
          select.innerHTML = '<option value="">目前無可報名場次</option>';
          return;
        }

        select.innerHTML = '<option value="">請選擇場次</option>';
        data.forEach(item => {
          const option = document.createElement('option');
          option.value = item.name;
          option.textContent = `${item.name} (${item.endDate})`;
          select.appendChild(option);
        });
      } catch (err) {
        console.error('載入場次失敗：', err);
        select.innerHTML = '<option value="">載入失敗</option>';
      }
    }

    // 初始化
    document.addEventListener('DOMContentLoaded', loadSessions);
  </script>
</body>
</html>
